#!/bin/sh
# Proper header for a Bash script.

DEPLOY_ADDRESS="/var/www/rivi.senman.cz/app"
DEPLOY_ROOT="/var/www/rivi.senman.cz"

SUDO="sudo"



echo "Start deploy ..."


echo -n "You wanna git pull? ([y]/n) "
read answer
if echo "$answer" | grep -iq "^n" ;then
    echo "."
else
    cd ${DEPLOY_ROOT} && ${SUDO} git pull && cd -
fi




echo -n "You wanna composer self-update? (y/[n]) "
read answer
if echo "$answer" | grep -iq "^y" ;then
    ${SUDO} /usr/local/bin/composer.phar self-update
else
    echo "."
fi



echo -n "You wanna composer update? (y/[n]) "
read answer
if echo "$answer" | grep -iq "^y" ;then
    ${SUDO} composer.phar update -d ${DEPLOY_ROOT}
else
    echo "."
fi


echo -n "You wanna composer dump-autoload? (y/[n]) "
read answer
if echo "$answer" | grep -iq "^y" ;then
    ${SUDO}  composer.phar dump-autoload -d ${DEPLOY_ROOT}
else
    echo "."
fi


echo -n "You wanna artisan dump-autoload? (y/[n]) "
read answer
if echo "$answer" | grep -iq "^y" ;then
    php ${DEPLOY_ROOT}/artisan dump-autoload
else
    echo "."
fi



echo -n "You wanna artisan migrate? ([y]/n) "
read answer
if echo "$answer" | grep -iq "^n" ;then
    echo "no"
else
    php ${DEPLOY_ROOT}/artisan migrate
fi





# chmod -R o+w storage #maybee this ?